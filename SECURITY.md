# 安全说明

## 🔒 当前安全措施

### 1. 管理后台安全
- ✅ **密码保护**：所有敏感操作需要密码认证
- ✅ **JWT Token**：使用 JWT 进行身份验证
- ✅ **Token 过期**：Token 24 小时后自动过期
- ✅ **登录限制**：5 次失败后锁定 5 分钟
- ✅ **环境变量**：密码存储在环境变量中，不硬编码
- ✅ **HTTPS**：Render/Vercel 默认支持 HTTPS

### 2. 数据安全
- ✅ **Supabase RLS**：建议在 Supabase 中启用 Row Level Security
- ✅ **API Key 保护**：Supabase Key 存储在环境变量中
- ✅ **无敏感信息泄露**：代码中不包含任何密钥或密码

### 3. GitHub 仓库安全

#### ✅ 当前状态：相对安全
- 代码中**没有硬编码**的密码、密钥、Token
- 所有敏感信息都从**环境变量**读取
- 即使代码被复制，**没有环境变量也无法使用**

#### ⚠️ 潜在风险
1. **公开仓库**：任何人都能看到代码逻辑
2. **依赖漏洞**：第三方库可能有安全漏洞
3. **配置泄露**：如果误提交了 `.env` 文件

## 🛡️ 安全建议

### 1. 密码设置
- ✅ 使用**复杂密码**（至少 16 位，包含大小写字母、数字、符号）
- ✅ **定期更换**密码（建议每 3 个月）
- ✅ **不要分享**密码给他人
- ✅ 使用**密码管理器**生成和存储密码

### 2. 环境变量保护
- ✅ **不要**在代码中硬编码任何密钥
- ✅ **不要**在 GitHub 提交 `.env` 文件
- ✅ **定期轮换**API Key 和 Token
- ✅ 使用**不同的密码**用于不同服务

### 3. Supabase 安全
- ✅ 启用 **Row Level Security (RLS)**
- ✅ 限制 **API Key 权限**（只读/只写）
- ✅ 定期**备份数据**
- ✅ 监控**异常访问**

### 4. 部署平台安全
- ✅ 使用 **HTTPS**（Render/Vercel 默认支持）
- ✅ 启用**访问日志**监控
- ✅ 设置**自动备份**
- ✅ 定期**更新依赖**（修复安全漏洞）

### 5. 代码仓库安全

#### 如果担心代码被复制：
1. **改为私有仓库**（GitHub Pro 或企业版）
2. **添加 License**：明确使用条款
3. **代码混淆**：让代码难以理解（不推荐，影响维护）
4. **核心逻辑加密**：关键算法加密存储（复杂，不推荐）

#### 当前建议：
- ✅ 代码**公开也没关系**（因为没有敏感信息）
- ✅ 关键在**环境变量**（只有你知道）
- ✅ 即使代码被复制，**没有环境变量也无法使用**

## 🚨 如果发现被攻击

### 立即行动：
1. **修改密码**：立即更改 `ADMIN_PASSWORD`
2. **检查日志**：查看 Supabase 和部署平台的访问日志
3. **撤销 Token**：如果怀疑 Token 泄露，修改 `ADMIN_SECRET`
4. **检查数据**：确认是否有异常数据修改
5. **通知用户**：如果涉及多人使用，通知其他用户

### 预防措施：
1. **定期检查**登录日志
2. **监控异常**访问模式
3. **及时更新**依赖包
4. **备份数据**（建议每天）

## 📋 安全检查清单

- [ ] 设置了复杂的管理密码（16位以上）
- [ ] 所有环境变量都已配置
- [ ] Supabase 启用了 RLS
- [ ] 使用 HTTPS 访问
- [ ] 定期备份数据
- [ ] 监控访问日志
- [ ] 定期更新依赖
- [ ] 没有在代码中硬编码密钥
- [ ] `.env` 文件已加入 `.gitignore`

## 🔐 最佳实践

1. **最小权限原则**：只给必要的权限
2. **定期审计**：检查访问日志和异常行为
3. **多层防护**：密码 + Token + HTTPS
4. **及时更新**：修复已知安全漏洞
5. **备份恢复**：定期备份，能快速恢复

## 📞 安全事件报告

如果发现安全漏洞，请：
1. 立即修改相关密码和密钥
2. 检查是否有数据泄露
3. 更新到最新版本
4. 必要时联系平台支持

---

**记住**：安全是一个持续的过程，不是一次性的设置。定期检查和更新是保持安全的关键。

